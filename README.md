> 🌐 This document is written in English. Please disable automatic translation in your browser for accurate reading.
> 
> 📌 本ドキュメントは英語で記述されている箇所がございます。正しく表示するため、自動翻訳機能をオフにすることを推奨します。

# Minecraft用　鉱石採掘ゲーム（OreMining）⛏

## はじめに
本リポジトリはJavaエンジニア転職を目指す「たか」（Xアカウント：https://x.com/5qhRg ） が作成したMinecraftプラグイン「鉱石採掘ゲーム（OreMining）」に関するものです。

## ゲームの概要
- 30秒のゲーム時間内に様々な種類の鉱石ブロックを採掘して、点数を競うゲームです。
- 出現割合が低いものほど高得点を獲得できます。

## プレイ動画
![デモ](./鉱石採掘ゲーム.gif)

## ゲームの詳細

#### ゲーム開始
>  oreminingとコマンドを入力すると、ゲームステージにテレポートしてゲームが開始されます。

#### 装備の配布
>  ゲーム開始時、メインハンドにネザライトのツルハシがセットされます。

#### 鉱石ブロック
>  ゲームステージ内に2か所、4×4×4（合計64個）の鉱石ブロックが出現します。<br>鉱石の種類によって点数や出現率が異なり、出現率が低いものほど高得点となります。

#### ゲーム終了
>  ゲームが終了して10秒後に、コマンドを入力した場所に戻ります。<br>装備についても、コマンド入力前の装備に戻ります。

#### スコアの表示
>  ゲーム終了後、点数が表示され、データベースに保存されます。

#### スコアの確認
>  /oremining listとコマンドを入力すると、過去のスコアを確認できます。

## コマンド

| コマンド | 説明 |
| ------- | ---- |
| `/oremining` | ゲームを開始する |
| `/oremining list` | 過去のスコアを表示する |

## 得点一覧

| 鉱石名 | スコア |
| ------ | ----- |
| ネザー金鉱石 | 100 P |
| エメラルド鉱石 | 30 P |
| ダイヤモンド鉱石 | 20 P |
| 金鉱石 | 10 P |
| ラピスラズリ鉱石 | 5 P |
| その他の鉱石 | 0 P |

## 対応バージョン

- Minecraft:1.21

- Spigot:1.21.1

## データベース構成
テーブル：`player_score`

| 属性 | 設定値 |
|-|-|
| id | プレイ回数（自動採番） |
| player_name | プレイヤー名 |
| score | スコア |
| registered_at | 登録日時 |

## データベースの接続方法

1. 自身のローカル環境でMySQLに接続して下さい。

2. 以下のコマンドを順に実行して下さい。

```
CREATE　DATABASE　spigot_server;
```

```
USE　spigot_server;
```

```
CREATE　TABLE　player_score(id int auto_increment, player_name, varchar(100), score int, registered_at datetime, primary key(id)) DEFAULT CHARSET=utf8
```


## こだわりポイント

- ゲームステージを制作し、コマンド入力後はテレポートをしてゲームステージに移動できるようにしました。<br>ゲーム終了後は、ゲーム開始前の場所へ戻るようにしました。

- ステージ内の床や壁、天井を破壊してしまうことがあったので、ゲーム終了後は復元するようにしました。

- 鉱石の出現割合を設定して、割合が低いものほど高得点を獲得できるようにしました。


## 苦労した点

- 4×4×4のブロックを出現させる際に、runTaskTimerの設定が上手にできず、ブロックが無限に出現してきたり、ブロックの種類がランダムではなく、種類ごとに綺麗に並んで出現したりと、なにが原因か分からずに悩みました。

- 制作したゲームステージには、安山岩を敷き詰めたつもりでいましたが、ゲーム終了後に、破壊された壁や床、天井を元通りに復元させるために安山岩を設定して復元を試みましたが、綺麗に復元されず。原因を調べると別の種類のブロックが混ざっていたが、コードに問題があると思い込んで、実装までに時間を費やしてしまいました。


## ハマったポイント

- ゲーム終了後に、ステージ内の破壊された壁や床、天井が綺麗に復元させるのがとても爽快で、ゲームが終了する瞬間が楽しみで制作していました。

- テレポートで指定した位置に移動し、ゲーム終了後にコマンドを実行した位置に戻る、視線の向きも調整してゲームステージの方に向けたりと、自分好みにカスタマイズできるところがとても楽しかったです。


## 展望

- 難易度を追加し、鉱石ブロックの出現場所をランダムにしたり、鉱石ブロック出現割合を変更する。

- ゲーム終了の5秒前からカウントダウンを表示する。

- Dockerの学習および導入をして、実行環境で動作させるまでの時間を軽減させる。
